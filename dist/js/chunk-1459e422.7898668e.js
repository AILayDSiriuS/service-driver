(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1459e422"],{1511:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"me-page"}},[n("Header"),n("Aside",{attrs:{active:"Главная"}}),n("div",{staticClass:"container"},[n("div",{staticClass:"row section first"},[n("div",{staticClass:"col-12 profile-header"},[n("div",{staticClass:"profile-header__left"},[n("div",{staticClass:"profile-picture"}),n("div",{staticClass:"profile-name"},[n("h3",[e._v(e._s(e.user.username))]),n("span",[e._v("USER")])])]),n("div",{staticClass:"profile-header__right"},[n("Button",{staticStyle:{"margin-right":"30px"},attrs:{isLink:"true",link:"/",textContent:"Сообщение",color:"btn-b"}}),e.isRequestSend||e.isFriend?e._e():n("Button",{attrs:{isLink:"false",textContent:"Добавить в друзья",color:"btn-b"},on:{action:e.sendFriendRequest}}),e.isRequestSend&&!e.isFriend?n("Button",{attrs:{isLink:"false",textContent:"Заявка отправлена",color:"btn-b btn-disabled"}}):e._e(),e.isFriend?n("Button",{attrs:{isLink:"false",textContent:"Удалить из друзей",color:"btn-g"}}):e._e()],1)])]),e.userFriends.length>0?n("div",{staticClass:"row section first"},[n("div",{staticClass:"col-12 profile-friends"},[e._m(0),n("div",{staticClass:"profile-friends__body"},e._l(e.userFriends,(function(e){return n("ProfileFriend",{key:e.id,attrs:{data:e}})})),1)])]):e._e()]),n("Footer")],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"profile-friends__topic"},[n("h4",[e._v("Друзья")]),n("span",[e._v("Показать всех")])])}],a=(n("99af"),n("7db0"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),o={name:"User",data:function(){return{id:"",email:"",username:"",uid:this.$route.params["id"],user:{id:"",username:""},isRequestSend:!1,isFriend:!1,requests:"",friends:"",userFriends:""}},beforeMount:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!document.cookie){e.next=13;break}return t=document.cookie,n=t.replace(/token=/g,""),e.next=4,this.getData(n);case 4:return e.next=6,this.getUser(n);case 6:return e.next=8,this.checkRequestState(n);case 8:return e.next=10,this.checkFriendState(n);case 10:this.getFriends(n),e.next=14;break;case 13:this.$router.push({name:"Signin"});case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getData:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n,redirect:"follow"};fetch("http://95.214.62.187/auth/me/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.type=n.data.type,t.id=n.data.id,t.username=n.data.attributes.username,t.email=n.data.attributes.email})).catch((function(e){return console.log("error",e)}))},getUser:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r=new URLSearchParams;r.append("user_id",this.uid);var i={method:"POST",headers:n,body:r};fetch("http://95.214.62.187/api/v1/main/users/",i).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);console.log(n),t.user.username="".concat(n.data.data[0].first_name," ").concat(n.data.data[0].last_name),t.user.id=n.data.data[0].id,t.id==t.uid&&(console.log("а ну брысь"),t.$router.push("/me"))})).catch((function(e){return console.log("error",e)}))},sendFriendRequest:function(){var e,t=this;if(document.cookie){var n=document.cookie;e=n.replace(/token=/g,"")}else this.$router.push({name:"Signin"});var r=new Headers;r.append("Authorization","Token ".concat(e));var i=new URLSearchParams;i.append("friend_id",this.uid);var a={method:"POST",headers:r,body:i};fetch("http://95.214.62.187/api/v1/main/friendship/",a).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);console.log(n),t.isRequestSend=!0})).catch((function(e){return console.log("error",e)}))},checkRequestState:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n};fetch("http://95.214.62.187/api/v1/main/friendship/friend_requests/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.requests=n.data.data;var r=t.requests.find((function(e){return e.to_user==t.user.id}));void 0!=r&&(t.isRequestSend=!0)})).catch((function(e){return console.log("error",e)}))},checkFriendState:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n};fetch("http://95.214.62.187/api/v1/main/friendship/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.friends=n.data.data;var r=t.friends.find((function(e){return e.id==t.user.id}));void 0!=r&&(t.isFriend=!0)})).catch((function(e){return console.log("error",e)}))},getFriends:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n,redirect:"follow"};fetch("http://95.214.62.187/api/v1/main/friendship/friends/".concat(this.uid),r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.userFriends=n.data.data,0!=t.friends.length&&(t.isFriendListEmpty=!1)})).catch((function(e){return console.log("error",e)}))}},watch:{$route:function(e){this.uid=e.params["id"]}},components:{Header:function(){return n.e("chunk-4fd13215").then(n.bind(null,"0418"))},Aside:function(){return n.e("chunk-6b748234").then(n.bind(null,"3d13"))},Footer:function(){return n.e("chunk-d06359f4").then(n.bind(null,"fd2d"))},ProfileFriend:function(){return n.e("chunk-3230a706").then(n.bind(null,"99ea"))},Button:function(){return n.e("chunk-44baf13f").then(n.bind(null,"f577"))}}},s=o,c=(n("1dea"),n("2877")),d=Object(c["a"])(s,r,i,!1,null,"bf890c82",null);t["default"]=d.exports},"1dde":function(e,t,n){var r=n("d039"),i=n("b622"),a=n("2d00"),o=i("species");e.exports=function(e){return a>=51||!r((function(){var t=[],n=t.constructor={};return n[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"1dea":function(e,t,n){"use strict";var r=n("cc41"),i=n.n(r);i.a},"99af":function(e,t,n){"use strict";var r=n("23e7"),i=n("d039"),a=n("e8b5"),o=n("861d"),s=n("7b0b"),c=n("50c4"),d=n("8418"),u=n("65f0"),f=n("1dde"),h=n("b622"),l=n("2d00"),p=h("isConcatSpreadable"),v=9007199254740991,m="Maximum allowed index exceeded",b=l>=51||!i((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),k=f("concat"),g=function(e){if(!o(e))return!1;var t=e[p];return void 0!==t?!!t:a(e)},_=!b||!k;r({target:"Array",proto:!0,forced:_},{concat:function(e){var t,n,r,i,a,o=s(this),f=u(o,0),h=0;for(t=-1,r=arguments.length;t<r;t++)if(a=-1===t?o:arguments[t],g(a)){if(i=c(a.length),h+i>v)throw TypeError(m);for(n=0;n<i;n++,h++)n in a&&d(f,h,a[n])}else{if(h>=v)throw TypeError(m);d(f,h++,a)}return f.length=h,f}})},cc41:function(e,t,n){}}]);
//# sourceMappingURL=chunk-1459e422.7898668e.js.map