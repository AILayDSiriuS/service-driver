(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-df29e664"],{5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),a=n("5899"),i="["+a+"]",o=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),c=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:c(1),end:c(2),trim:c(3)}},7156:function(e,t,n){var r=n("861d"),a=n("d2bb");e.exports=function(e,t,n){var i,o;return a&&"function"==typeof(i=t.constructor)&&i!==n&&r(o=i.prototype)&&o!==n.prototype&&a(e,o),e}},a9e3:function(e,t,n){"use strict";var r=n("83ab"),a=n("da84"),i=n("94ca"),o=n("6eeb"),s=n("5135"),c=n("c6b6"),u=n("7156"),d=n("c04e"),f=n("d039"),h=n("7c73"),p=n("241c").f,l=n("06cf").f,v=n("9bf2").f,b=n("58a8").trim,m="Number",g=a[m],k=g.prototype,N=c(h(k))==m,S=function(e){var t,n,r,a,i,o,s,c,u=d(e,!1);if("string"==typeof u&&u.length>2)if(u=b(u),t=u.charCodeAt(0),43===t||45===t){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+u}for(i=u.slice(2),o=i.length,s=0;s<o;s++)if(c=i.charCodeAt(s),c<48||c>a)return NaN;return parseInt(i,r)}return+u};if(i(m,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var I,x=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof x&&(N?f((function(){k.valueOf.call(n)})):c(n)!=m)?u(new g(S(t)),n,x):S(t)},_=r?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;_.length>E;E++)s(g,I=_[E])&&!s(x,I)&&v(x,I,l(g,I));x.prototype=k,k.constructor=x,o(a,m,x)}},ba15:function(e,t,n){},bd2e:function(e,t,n){"use strict";var r=n("ba15"),a=n.n(r);a.a},e282:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user-block"},[n("router-link",{attrs:{to:"/users/"+e.data.id}},[n("div",{staticClass:"user-data"},[n("div",{staticClass:"user-picture"}),n("h4",[e._v(e._s(e.data.first_name)+" "+e._s(e.data.last_name))])])]),e.isRequestSend||e.isFriend||!e.isNotYou?e._e():n("Button",{attrs:{isLink:"false",textContent:"Добавить в друзья",color:"btn-b"},on:{action:e.sendFriendRequest}}),e.isRequestSend&&!e.isFriend?n("Button",{attrs:{isLink:"false",textContent:"Заявка отправлена",color:"btn-b btn-disabled"}}):e._e(),e.isFriend?n("Button",{attrs:{isLink:"false",textContent:"Удалить из друзей",color:"btn-g"}}):e._e()],1)},a=[],i=(n("7db0"),n("a9e3"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),o={name:"User",props:{data:{type:Object,default:function(){return{}}},id:Number},data:function(){return{isRequestSend:!1,isFriend:!1,requests:"",friends:"",userFriends:"",myId:""}},beforeMount:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!document.cookie){t.next=11;break}return n=document.cookie,r=n.replace(/token=/g,""),t.next=4,e.getData(r);case 4:return t.next=6,e.checkRequestState(r);case 6:return t.next=8,e.checkFriendState(r);case 8:e.getFriends(r),t.next=12;break;case 11:e.$router.push({name:"Signin"});case 12:case"end":return t.stop()}}),t)})))()},components:{Button:function(){return n.e("chunk-44baf13f").then(n.bind(null,"f577"))}},computed:{isNotYou:function(){return this.myId!=this.data.id}},methods:{getData:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n,redirect:"follow"};fetch("http://95.214.62.187/auth/me/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.myId=parseInt(n.data.id)})).catch((function(e){return console.log("error",e)}))},sendFriendRequest:function(){var e,t=this;if(document.cookie){var n=document.cookie;e=n.replace(/token=/g,"")}else this.$router.push({name:"Signin"});var r=new Headers;r.append("Authorization","Token ".concat(e));var a=new URLSearchParams;a.append("friend_id",this.data.id);var i={method:"POST",headers:r,body:a};fetch("http://95.214.62.187/api/v1/main/friendship/",i).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);console.log(n),t.isRequestSend=!0})).catch((function(e){return console.log("error",e)}))},checkRequestState:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n};fetch("http://95.214.62.187/api/v1/main/friendship/friend_requests/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.requests=n.data.data;var r=t.requests.find((function(e){return e.to_user==t.data.id}));void 0!=r&&(t.isRequestSend=!0)})).catch((function(e){return console.log("error",e)}))},checkFriendState:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n};fetch("http://95.214.62.187/api/v1/main/friendship/",r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.friends=n.data.data;var r=t.friends.find((function(e){return e.id==t.data.id}));void 0!=r&&(t.isFriend=!0)})).catch((function(e){return console.log("error",e)}))},getFriends:function(e){var t=this,n=new Headers;n.append("Authorization","Token ".concat(e));var r={method:"GET",headers:n,redirect:"follow"};fetch("http://95.214.62.187/api/v1/main/friendship/friends/".concat(this.data.id),r).then((function(e){return e.text()})).then((function(e){var n=JSON.parse(e);t.userFriends=n.data.data,0!=t.friends.length&&(t.isFriendListEmpty=!1)})).catch((function(e){return console.log("error",e)}))}}},s=o,c=(n("bd2e"),n("2877")),u=Object(c["a"])(s,r,a,!1,null,"10bf52eb",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-df29e664.b57e5245.js.map